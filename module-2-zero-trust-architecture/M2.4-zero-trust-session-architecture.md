# ğŸ“„ **M2.4 â€” Zero Trust Session Architecture  
(STS + Continuous Access Evaluation + Token Lifetimes)**

**StageCloud Academy â€” Module 2: Zero Trust Architecture (ZTA)**  
**Multi-Cloud Control Plane Edition**

---

## ğŸŒŸ Introduction â€” The Forgotten Battlefront of Zero Trust

Most Zero Trust discussions focus on:

- Identity  
- Devices  
- Network segmentation  

But **sessions** â€” the temporary â€œpermit to operateâ€ â€” are often ignored.

A **session** is:

> the unbroken period of time during which a user or workload is trusted.

Zero Trust requires:

- short sessions  
- decaying trust  
- continuous reevaluation  

This document explains:

- AWS STS sessions  
- Azure Continuous Access Evaluation (CAE)  
- Token lifetime risks  
- Session boundary enforcement  
- How SecureTheCloud unifies multi-cloud session trust  

---

# âš™ï¸ 1. The Life of a Session (What Happens Behind the Scenes)

When a user logs into AWS via Entra ID:

1ï¸âƒ£ **Azure authenticates the identity**  
2ï¸âƒ£ **AWS IAM Identity Center issues an STS session**  
3ï¸âƒ£ **AWS grants temporary permissions via session policies**  
4ï¸âƒ£ **Trust remains only while the STS session is valid**  
5ï¸âƒ£ **Azure CAE may revoke the session before expiration**  
6ï¸âƒ£ **AWS logs every action via CloudTrail**

This lifecycle *is* the foundation of Zero Trust.

---

# ğŸ”‘ 2. AWS STS â€” Short-Lived Credential Engine

AWS uses STS to provide:

- Temporary credentials  
- Bounded session duration  
- Role scoping  
- Trust-policy-based access  

Every federated login â†’ **creates an STS session**.

### ğŸ•’ Default AWS STS Durations

| STS Session Type | Duration |
|------------------|----------|
| Console login (AWS SSO) | **1 hour (default)** |
| Programmatic access | **15 min â€“ 12 hours** |
| Role chaining | **1 hour max** |
| Scoped-down session | **1 hour max** |

### Zero Trust principle:
> **Shorter sessions = smaller attack window.**

---

# ğŸ§¨ 3. Why Long Sessions Are Dangerous

If a token or STS credential is stolen:

- attacker stays authenticated  
- until the session expires (even if user leaves!)  

### Example failure:
User logs in  
Laptop stolen  
Token still valid  
Attacker keeps access for 12 hours  

Zero Trust rule:

> **Never let trust outlive the conditions that created it.**

---

# âœ‚ï¸ 4. Zero Trust Session Boundary Controls in AWS

## âœ” 4.1 Enforce Shorter Session Lifetimes

AWS IAM Identity Center â†’  
**Settings â†’ Authentication â†’ Session Duration**

Set:

- Console session â†’ **15 minutes**  
- Programmatic STS â†’ **1 hour**  

This forces continuous reevaluation.

---

## âœ” 4.2 Use AWS STS Session Policies (Critical Zero Trust Control)

Session policies *restrict* permissions even if the role is powerful.

### Example:
Role = Administrator  
Session policy = deny sensitive actions

```json
{
  "Deny": {
    "Action": [
      "iam:CreateUser",
      "s3:ListBucket",
      "ec2:Delete*"
    ],
    "Effect": "Deny",
    "Resource": "*"
  }
}
```

This is **privilege decay** â€” a core Zero Trust concept.

---

## âœ” 4.3 Add Context-Based Conditions

```json
"Condition": {
  "IpAddress": { "aws:SourceIp": "10.0.0.0/16" },
  "Bool": { "aws:MultiFactorAuthPresent": true }
}
```

Restricts:

- IP  
- MFA  
- VPC-only access  

---

# ğŸ’¢ 5. Azure Continuous Access Evaluation (CAE)

CAE allows Entra to **revoke sessions instantly** when:

- User risk increases  
- Password changes  
- MFA changes  
- Suspicious sign-ins  
- Device becomes non-compliant  

CAE does **not** wait for token expiration.

### Example:  
Azure detects risk â†’  
CAE revokes â†’  
AWS session breaks at next request â†’  
User kicked out immediately  

This is **continuous trust reevaluation**.

---

# ğŸ”„ 6. Token Lifetime Architecture  
### (JWT, Refresh Tokens, STS Limits)

Understanding token longevity is essential for Zero Trust.

---

## 6.1 Azure Tokens

| Token Type | Lifetime |
|------------|-----------|
| Access Token | **1 hour** |
| Refresh Token | **24 hours (rotating)** |
| ID Token | **1 hour** |
| CAE Refresh | **continuous** |

---

## 6.2 AWS Tokens

AWS relies on:

- IdP token (one-time for federation)  
- STS token (temporary session credential)  

**No refresh tokens.  
No reuse.  
No persistent sessions.**

---

# ğŸ§  7. Why Token Lifetime Matters for Zero Trust

Long-lived tokens = long-lived compromise.

Zero Trust reduces risk through:

- Short STS sessions  
- MFA requirements  
- Conditional Access  
- Session policies  
- CAE signals  

SecureTheCloudâ€™s Control Plane combines all of these.

---

# ğŸŒ 8. Multi-Cloud Session Architecture Diagram

```
                   +-----------------------------+
                   |  Azure Entra ID (Identity)  |
                   | CAE, CA, MFA, Device Trust  |
                   +---------------+-------------+
                                   |
                                   | SAML Assertion
                                   v
                    +--------------+------------------+
                    | AWS IAM Identity Center         |
                    | STS Issuance + Session Policies |
                    +--------------+------------------+
                                   |
                                   | Temporary Credentials
                                   v
                    +--------------+------------------+
                    | AWS Workloads / Console Access  |
                    | GuardDuty + CloudTrail Monitor  |
                    +---------------------------------+
```

---

# ğŸ” 9. StageCloud Session Trust Decay Model  
## (SC-STD)

The SC Control Plane enforces **four layers of trust decay**:

### **Step 1 â€” Strong Identity Verification (Azure)**  
MFA, CA, device trust, risk scoring

### **Step 2 â€” STS Session Creation (AWS)**  
Short-lived  
Scoped permissions  
Role restrictions  

### **Step 3 â€” Continuous Reevaluation**  
CAE revocation  
Session policy enforcement  
GuardDuty + CloudTrail alerts  

### **Step 4 â€” Automatic Trust Decay**  
Session expiration  
Token invalidation  
Risk-triggered logout  

This forms a **Zero Trust feedback loop**.

---

# ğŸš¨ 10. Real Interview Scenarios (MGF-Validated)

### â“ â€œHow do you implement Zero Trust session control in AWS?â€  
â†’ STS short lifetimes + session policies + MFA.

### â“ â€œHow does Azure CAE improve AWS federation security?â€  
â†’ Immediate revocation across clouds.

### â“ â€œHow do you prevent lateral movement after token theft?â€  
â†’ IP restrictions + short STS sessions + CAE triggers.

### â“ â€œExplain Zero Trust token lifetime design.â€  
â†’ Short-lived STS + CAE + conditional access + continuous verification.

---

# ğŸ Conclusion

**Identity verifies WHO you are.  
Session architecture controls HOW LONG you remain trusted.**

Zero Trust sessions are the beating heart of the SecureTheCloud Control Plane.

They ensure:

âœ” Trust continuously reevaluated  
âœ” Sessions never outlive their security conditions  
âœ” Users cannot pivot across clouds with stale tokens  
âœ” Breach blast radius minimized  

You now understand one of the most important (and most overlooked) layers of Zero Trust.

---

# END OF FILE
